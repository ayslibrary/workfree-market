# ğŸ—ï¸ WorkFree Market ê¸°ìˆ  ì•„í‚¤í…ì²˜

> ì‹¤ë¬´ ìë™í™” í‚¤íŠ¸ ê±°ë˜ì†Œì˜ ì „ì²´ ì‹œìŠ¤í…œ ì„¤ê³„ ë¬¸ì„œ

---

## ğŸ“ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ì‚¬ìš©ì (ë¸Œë¼ìš°ì €)                      â”‚
â”‚                 êµ¬ë§¤ì / íŒë§¤ì / ê´€ë¦¬ì                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CDN (Cloudflare)                          â”‚
â”‚              â€¢ DDoS ë°©ì–´  â€¢ SSL/TLS  â€¢ ìºì‹±                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Frontend (Next.js 15)                        â”‚
â”‚  â€¢ App Router  â€¢ Server Components  â€¢ API Routes           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                          â”‚
        â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Firebase Auth   â”‚      â”‚   Supabase DB        â”‚
â”‚  â€¢ ì†Œì…œ ë¡œê·¸ì¸   â”‚      â”‚   â€¢ ì‚¬ìš©ì ì •ë³´      â”‚
â”‚  â€¢ ì´ë©”ì¼ ì¸ì¦   â”‚      â”‚   â€¢ í‚¤íŠ¸ ë©”íƒ€ë°ì´í„°  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â€¢ ê±°ë˜ ë‚´ì—­        â”‚
                          â”‚   â€¢ ë¦¬ë·°/í‰ì         â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Business Logic Layer                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ê²°ì œ ì²˜ë¦¬   â”‚  íŒŒì¼ ê´€ë¦¬   â”‚  ê²€ìˆ˜ ì‹œìŠ¤í…œ â”‚  ì•Œë¦¼ ì‹œìŠ¤í…œ   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚              â”‚                â”‚
       â–¼              â–¼              â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Stripe    â”‚ â”‚  AWS S3  â”‚ â”‚ VirusTotal  â”‚ â”‚   Zapier     â”‚
â”‚   Toss Pay  â”‚ â”‚CloudFrontâ”‚ â”‚     API     â”‚ â”‚Power Automateâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸

### 1. Frontend Stack

#### Core Framework
```typescript
// Next.js 15 with App Router
- Server Components (ê¸°ë³¸ ë Œë”ë§)
- Client Components (ìƒí˜¸ì‘ìš©)
- API Routes (ì„œë²„ë¦¬ìŠ¤ ì—”ë“œí¬ì¸íŠ¸)
- ISR (Incremental Static Regeneration) for ìƒí’ˆ í˜ì´ì§€
```

#### UI Library & Styling
```typescript
- Tailwind CSS 4: ìœ í‹¸ë¦¬í‹° ê¸°ë°˜ ìŠ¤íƒ€ì¼
- Framer Motion: ì• ë‹ˆë©”ì´ì…˜ (ì„ íƒì‚¬í•­)
- Radix UI: ì ‘ê·¼ì„± ë†’ì€ ì»´í¬ë„ŒíŠ¸
- React Icons: ì•„ì´ì½˜ ë¼ì´ë¸ŒëŸ¬ë¦¬
```

#### State Management
```typescript
- Zustand: ê¸€ë¡œë²Œ ìƒíƒœ ê´€ë¦¬ (ì¥ë°”êµ¬ë‹ˆ, ì‚¬ìš©ì ì •ë³´)
- React Query: ì„œë²„ ìƒíƒœ ê´€ë¦¬ ë° ìºì‹±
- Context API: í…Œë§ˆ, ë¡œì¼€ì¼ ê´€ë¦¬
```

---

### 2. ì¸ì¦ ì‹œìŠ¤í…œ (Firebase Auth)

#### êµ¬í˜„ ë°©ì‹
```typescript
// lib/firebase.ts
import { initializeApp } from 'firebase/app';
import { getAuth, GoogleAuthProvider, signInWithPopup } from 'firebase/auth';

const firebaseConfig = {
  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,
  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,
  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,
};

export const app = initializeApp(firebaseConfig);
export const auth = getAuth(app);
export const googleProvider = new GoogleAuthProvider();
```

#### ì§€ì› ë¡œê·¸ì¸ ë°©ì‹
- ğŸ”µ Google OAuth
- ğŸ’¬ Kakao OAuth
- ğŸŸ¢ Naver OAuth
- ğŸ“§ ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸
- ğŸ“± ì „í™”ë²ˆí˜¸ (SMS ì¸ì¦)

#### ê¶Œí•œ ê´€ë¦¬
```typescript
// types/user.ts
type UserRole = 'buyer' | 'seller' | 'admin';

interface User {
  uid: string;
  email: string;
  displayName: string;
  role: UserRole;
  sellerLevel?: 'standard' | 'verified' | 'top-creator';
  createdAt: Date;
}
```

---

### 3. ë°ì´í„°ë² ì´ìŠ¤ (Supabase)

#### í…Œì´ë¸” êµ¬ì¡°

##### `kits` (ìë™í™” í‚¤íŠ¸)
```sql
CREATE TABLE kits (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  seller_id UUID REFERENCES users(id),
  title VARCHAR(200) NOT NULL,
  description TEXT,
  price INTEGER NOT NULL,
  category VARCHAR(50),
  tags TEXT[],
  preview_images TEXT[],
  file_url TEXT NOT NULL,
  download_count INTEGER DEFAULT 0,
  rating DECIMAL(2,1) DEFAULT 0,
  review_count INTEGER DEFAULT 0,
  is_approved BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_kits_category ON kits(category);
CREATE INDEX idx_kits_seller ON kits(seller_id);
CREATE INDEX idx_kits_rating ON kits(rating DESC);
```

##### `transactions` (ê±°ë˜ ë‚´ì—­)
```sql
CREATE TABLE transactions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  buyer_id UUID REFERENCES users(id),
  kit_id UUID REFERENCES kits(id),
  amount INTEGER NOT NULL,
  payment_method VARCHAR(50),
  payment_id VARCHAR(200),
  status VARCHAR(20) DEFAULT 'pending',
  downloaded_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_transactions_buyer ON transactions(buyer_id);
CREATE INDEX idx_transactions_kit ON transactions(kit_id);
```

##### `reviews` (ë¦¬ë·°)
```sql
CREATE TABLE reviews (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  transaction_id UUID REFERENCES transactions(id),
  kit_id UUID REFERENCES kits(id),
  buyer_id UUID REFERENCES users(id),
  rating INTEGER CHECK (rating >= 1 AND rating <= 5),
  comment TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_reviews_kit ON reviews(kit_id);
```

##### `seller_payouts` (íŒë§¤ì ì •ì‚°)
```sql
CREATE TABLE seller_payouts (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  seller_id UUID REFERENCES users(id),
  amount INTEGER NOT NULL,
  transaction_count INTEGER,
  period_start DATE,
  period_end DATE,
  status VARCHAR(20) DEFAULT 'pending',
  paid_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);
```

---

### 4. ê²°ì œ ì‹œìŠ¤í…œ

#### Stripe Connect êµ¬ì¡°

```typescript
// lib/stripe.ts
import Stripe from 'stripe';

export const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {
  apiVersion: '2024-12-18.acacia',
});

// íŒë§¤ì ê³„ì • ìƒì„±
export async function createSellerAccount(userId: string, email: string) {
  const account = await stripe.accounts.create({
    type: 'express',
    country: 'KR',
    email: email,
    capabilities: {
      card_payments: { requested: true },
      transfers: { requested: true },
    },
  });
  
  return account.id;
}

// ê²°ì œ ìƒì„± (ìˆ˜ìˆ˜ë£Œ ìë™ ê³„ì‚°)
export async function createPayment(
  amount: number,
  sellerId: string,
  platformFee: number = 0.25 // 25% ìˆ˜ìˆ˜ë£Œ
) {
  const applicationFee = Math.round(amount * platformFee);
  
  const paymentIntent = await stripe.paymentIntents.create({
    amount: amount,
    currency: 'krw',
    application_fee_amount: applicationFee,
    transfer_data: {
      destination: sellerId, // íŒë§¤ì Stripe ê³„ì •
    },
  });
  
  return paymentIntent;
}
```

#### Toss Payments í†µí•©

```typescript
// lib/toss.ts
export async function initTossPayment(orderId: string, amount: number) {
  const response = await fetch('https://api.tosspayments.com/v1/payments', {
    method: 'POST',
    headers: {
      'Authorization': `Basic ${Buffer.from(process.env.TOSS_SECRET_KEY + ':').toString('base64')}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      orderId,
      amount,
      orderName: 'ìë™í™” í‚¤íŠ¸ êµ¬ë§¤',
      successUrl: `${process.env.NEXT_PUBLIC_URL}/payment/success`,
      failUrl: `${process.env.NEXT_PUBLIC_URL}/payment/fail`,
    }),
  });
  
  return await response.json();
}
```

---

### 5. íŒŒì¼ ì €ì¥ ë° ë‹¤ìš´ë¡œë“œ (AWS S3)

#### S3 ë²„í‚· êµ¬ì¡°
```
workfree-market-files/
â”œâ”€â”€ kits/
â”‚   â”œâ”€â”€ {kit_id}/
â”‚   â”‚   â”œâ”€â”€ main.zip (ì•”í˜¸í™”ëœ í‚¤íŠ¸ íŒŒì¼)
â”‚   â”‚   â”œâ”€â”€ preview.png
â”‚   â”‚   â””â”€â”€ metadata.json
â”œâ”€â”€ previews/
â”‚   â””â”€â”€ {kit_id}/
â”‚       â””â”€â”€ code-snippet.txt
â””â”€â”€ licenses/
    â””â”€â”€ default-license.txt
```

#### íŒŒì¼ ì—…ë¡œë“œ
```typescript
// lib/s3.ts
import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';

const s3Client = new S3Client({
  region: process.env.AWS_REGION,
  credentials: {
    accessKeyId: process.env.AWS_ACCESS_KEY_ID!,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY!,
  },
});

export async function uploadKit(
  kitId: string,
  file: File,
  sellerId: string
) {
  const key = `kits/${kitId}/main.zip`;
  
  const command = new PutObjectCommand({
    Bucket: process.env.AWS_S3_BUCKET,
    Key: key,
    Body: Buffer.from(await file.arrayBuffer()),
    ServerSideEncryption: 'AES256',
    Metadata: {
      sellerId: sellerId,
      uploadedAt: new Date().toISOString(),
    },
  });
  
  await s3Client.send(command);
  return key;
}
```

#### ì„ì‹œ ë‹¤ìš´ë¡œë“œ URL ìƒì„±
```typescript
import { getSignedUrl } from '@aws-sdk/s3-request-presigner';
import { GetObjectCommand } from '@aws-sdk/client-s3';

export async function generateDownloadUrl(
  kitId: string,
  userId: string,
  expiresIn: number = 3600 // 1ì‹œê°„
) {
  // êµ¬ë§¤ í™•ì¸
  const hasPurchased = await checkPurchase(userId, kitId);
  if (!hasPurchased) {
    throw new Error('Unauthorized');
  }
  
  const command = new GetObjectCommand({
    Bucket: process.env.AWS_S3_BUCKET,
    Key: `kits/${kitId}/main.zip`,
  });
  
  const url = await getSignedUrl(s3Client, command, { expiresIn });
  
  // ë‹¤ìš´ë¡œë“œ ë¡œê·¸ ê¸°ë¡
  await logDownload(userId, kitId);
  
  return url;
}
```

---

### 6. ìë™ ê²€ìˆ˜ ì‹œìŠ¤í…œ

#### VirusTotal API ì—°ë™
```typescript
// lib/security.ts
export async function scanFile(fileBuffer: Buffer): Promise<ScanResult> {
  const formData = new FormData();
  formData.append('file', new Blob([fileBuffer]));
  
  const response = await fetch('https://www.virustotal.com/api/v3/files', {
    method: 'POST',
    headers: {
      'x-apikey': process.env.VIRUSTOTAL_API_KEY!,
    },
    body: formData,
  });
  
  const data = await response.json();
  const analysisId = data.data.id;
  
  // ìŠ¤ìº” ê²°ê³¼ ëŒ€ê¸°
  await new Promise(resolve => setTimeout(resolve, 30000)); // 30ì´ˆ
  
  const analysisResponse = await fetch(
    `https://www.virustotal.com/api/v3/analyses/${analysisId}`,
    {
      headers: { 'x-apikey': process.env.VIRUSTOTAL_API_KEY! },
    }
  );
  
  const analysis = await analysisResponse.json();
  
  return {
    isSafe: analysis.data.attributes.stats.malicious === 0,
    detections: analysis.data.attributes.stats.malicious,
    scanDate: new Date(),
  };
}
```

#### ìë™ ê²€ìˆ˜ ì›Œí¬í”Œë¡œìš°
```typescript
// app/api/kits/upload/route.ts
export async function POST(request: Request) {
  const formData = await request.formData();
  const file = formData.get('file') as File;
  const sellerId = formData.get('sellerId') as string;
  
  // 1. íŒŒì¼ ìŠ¤ìº”
  const fileBuffer = Buffer.from(await file.arrayBuffer());
  const scanResult = await scanFile(fileBuffer);
  
  if (!scanResult.isSafe) {
    return Response.json({ error: 'ì•…ì„± ì½”ë“œê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.' }, { status: 400 });
  }
  
  // 2. ë¼ì´ì„ ìŠ¤ ì‚½ì…
  const kitWithLicense = await insertLicense(fileBuffer);
  
  // 3. S3 ì—…ë¡œë“œ
  const kitId = crypto.randomUUID();
  await uploadKit(kitId, new File([kitWithLicense], file.name), sellerId);
  
  // 4. DBì— í‚¤íŠ¸ ì •ë³´ ì €ì¥ (ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœ)
  const { data, error } = await supabase
    .from('kits')
    .insert({
      id: kitId,
      seller_id: sellerId,
      title: formData.get('title'),
      description: formData.get('description'),
      price: parseInt(formData.get('price') as string),
      is_approved: false, // ê´€ë¦¬ì ìŠ¹ì¸ í•„ìš”
    });
  
  // 5. ê´€ë¦¬ìì—ê²Œ ì•Œë¦¼ ì „ì†¡
  await notifyAdmin(kitId);
  
  return Response.json({ success: true, kitId });
}
```

---

### 7. ì½”ë“œ ë¯¸ë¦¬ë³´ê¸° (Monaco Editor)

```typescript
// components/CodePreview.tsx
'use client';

import Editor from '@monaco-editor/react';

interface CodePreviewProps {
  code: string;
  language: 'python' | 'javascript' | 'vba';
}

export function CodePreview({ code, language }: CodePreviewProps) {
  return (
    <Editor
      height="400px"
      language={language}
      value={code}
      theme="vs-dark"
      options={{
        readOnly: true,
        minimap: { enabled: false },
        scrollBeyondLastLine: false,
        fontSize: 14,
      }}
    />
  );
}
```

---

### 8. ìë™ ì´ë©”ì¼ ì‹œìŠ¤í…œ

#### Zapier ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ

```yaml
# êµ¬ë§¤ ì™„ë£Œ ì‹œ
Trigger: Supabase - New Row in 'transactions'
Actions:
  1. Gmail - Send Email
     To: {{ buyer_email }}
     Subject: "[WorkFree Market] êµ¬ë§¤ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"
     Body: |
       ì•ˆë…•í•˜ì„¸ìš” {{ buyer_name }}ë‹˜,
       
       {{ kit_title }} êµ¬ë§¤ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
       ì•„ë˜ ë§í¬ì—ì„œ ë‹¤ìš´ë¡œë“œí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
       
       ë‹¤ìš´ë¡œë“œ: {{ download_url }}
       (ë§í¬ëŠ” 24ì‹œê°„ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤)

# íŒë§¤ì ì •ì‚° ì‹œ
Trigger: Schedule - Monthly (ë§¤ì›” 1ì¼)
Actions:
  1. Supabase - Query Rows
     Table: transactions
     Filter: created_at >= last_month
     
  2. Stripe - Create Payout
     Amount: {{ calculated_amount }}
     Destination: {{ seller_stripe_account }}
     
  3. Gmail - Send Email
     To: {{ seller_email }}
     Subject: "[WorkFree Market] ì›”ê°„ ì •ì‚° ì™„ë£Œ"
```

#### Power Automate ëŒ€ì•ˆ

```typescript
// lib/email.ts
import nodemailer from 'nodemailer';

const transporter = nodemailer.createTransport({
  host: 'smtp.gmail.com',
  port: 587,
  secure: false,
  auth: {
    user: process.env.EMAIL_USER,
    pass: process.env.EMAIL_PASSWORD,
  },
});

export async function sendPurchaseEmail(
  buyerEmail: string,
  kitTitle: string,
  downloadUrl: string
) {
  await transporter.sendMail({
    from: '"WorkFree Market" <noreply@workfreemarket.com>',
    to: buyerEmail,
    subject: `[WorkFree Market] ${kitTitle} êµ¬ë§¤ ì™„ë£Œ`,
    html: `
      <h2>êµ¬ë§¤ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</h2>
      <p>ìë™í™” í‚¤íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      <a href="${downloadUrl}" style="display: inline-block; padding: 12px 24px; background: #9333ea; color: white; text-decoration: none; border-radius: 8px;">
        ë‹¤ìš´ë¡œë“œí•˜ê¸°
      </a>
      <p style="color: #666; font-size: 12px;">* ë§í¬ëŠ” 24ì‹œê°„ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤.</p>
    `,
  });
}
```

---

## ğŸ” ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### íŒŒì¼ ë³´ì•ˆ
- [x] VirusTotal API ìë™ ìŠ¤ìº”
- [x] S3 ì„œë²„ ì¸¡ ì•”í˜¸í™” (AES-256)
- [x] êµ¬ë§¤ìë³„ ì„ì‹œ ë‹¤ìš´ë¡œë“œ URL (1ì‹œê°„ ë§Œë£Œ)
- [x] íŒŒì¼ ë‚´ ë¼ì´ì„ ìŠ¤ ìë™ ì‚½ì…
- [x] ì—…ë¡œë“œ íŒŒì¼ í¬ê¸° ì œí•œ (ìµœëŒ€ 100MB)

### ê²°ì œ ë³´ì•ˆ
- [x] PCI-DSS ì¤€ìˆ˜ (Stripe/Toss ì‚¬ìš©)
- [x] ê²°ì œ ì •ë³´ ì €ì¥ ê¸ˆì§€
- [x] HTTPS ê°•ì œ ì ìš©
- [x] CSRF í† í° ê²€ì¦

### ë°ì´í„° ë³´ì•ˆ
- [x] Supabase Row Level Security (RLS)
- [x] API ìš”ì²­ Rate Limiting
- [x] í™˜ê²½ë³€ìˆ˜ ì•”í˜¸í™” (Vercel Secrets)
- [x] ì •ê¸° ë°±ì—… (ì¼ 1íšŒ)

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ & ë¶„ì„

### í•„ìˆ˜ ì§€í‘œ

```typescript
// ëŒ€ì‹œë³´ë“œì— í‘œì‹œí•  KPI
interface Metrics {
  // ë¹„ì¦ˆë‹ˆìŠ¤ ì§€í‘œ
  totalRevenue: number;
  dailyActiveUsers: number;
  conversionRate: number;
  averageOrderValue: number;
  
  // íŒë§¤ì ì§€í‘œ
  totalKits: number;
  approvalRate: number;
  averageRating: number;
  
  // ì‹œìŠ¤í…œ ì§€í‘œ
  apiLatency: number;
  downloadSpeed: number;
  errorRate: number;
}
```

### ì¶”ì²œ ë„êµ¬
- **Google Analytics 4**: ì‚¬ìš©ì í–‰ë™ ë¶„ì„
- **Sentry**: ì—ëŸ¬ íŠ¸ë˜í‚¹
- **Vercel Analytics**: ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
- **Stripe Dashboard**: ê²°ì œ ë¶„ì„

---

## ğŸš€ ë°°í¬ ì „ëµ

### í™˜ê²½ êµ¬ì„±

```bash
# .env.local (ê°œë°œí™˜ê²½)
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_FIREBASE_API_KEY=...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=...

# Production (Vercel í™˜ê²½ë³€ìˆ˜)
NEXT_PUBLIC_SITE_URL=https://workfreemarket.com
STRIPE_SECRET_KEY=sk_live_...
AWS_ACCESS_KEY_ID=...
SUPABASE_SERVICE_ROLE_KEY=...
```

### CI/CD íŒŒì´í”„ë¼ì¸

```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run tests
        run: npm test
        
      - name: Build
        run: npm run build
        
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}
          vercel-args: '--prod'
```

---

## ğŸ“ API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„

### Public API

```typescript
// GET /api/kits - í‚¤íŠ¸ ëª©ë¡ ì¡°íšŒ
// GET /api/kits/[id] - í‚¤íŠ¸ ìƒì„¸ ì¡°íšŒ
// GET /api/kits/search?q=ë©”ì¼ìë™í™” - ê²€ìƒ‰
// GET /api/kits/category/[category] - ì¹´í…Œê³ ë¦¬ë³„ ì¡°íšŒ

// POST /api/kits - í‚¤íŠ¸ ì—…ë¡œë“œ (íŒë§¤ì ì „ìš©)
// PUT /api/kits/[id] - í‚¤íŠ¸ ìˆ˜ì •
// DELETE /api/kits/[id] - í‚¤íŠ¸ ì‚­ì œ

// POST /api/payment/create - ê²°ì œ ìƒì„±
// POST /api/payment/confirm - ê²°ì œ í™•ì¸
// GET /api/download/[id] - ë‹¤ìš´ë¡œë“œ URL ìƒì„±

// POST /api/reviews - ë¦¬ë·° ì‘ì„±
// GET /api/reviews/[kitId] - í‚¤íŠ¸ ë¦¬ë·° ì¡°íšŒ
```

---

## ğŸ’¡ ì„±ëŠ¥ ìµœì í™”

### Next.js ìµœì í™”
- **App Router**: ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¡œ ì´ˆê¸° ë¡œë”© ì†ë„ ê°œì„ 
- **ISR**: ìƒí’ˆ í˜ì´ì§€ 5ë¶„ë§ˆë‹¤ ì¬ìƒì„±
- **Image Optimization**: next/imageë¡œ ìë™ ìµœì í™”
- **Code Splitting**: ë™ì  importë¡œ ë²ˆë“¤ í¬ê¸° ì¶•ì†Œ

### ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
- ì¸ë±ìŠ¤ ì„¤ì • (category, rating, created_at)
- Connection Pooling (Supabase ê¸°ë³¸ ì œê³µ)
- ì¿¼ë¦¬ ìºì‹± (React Query)

### CDN & ìºì‹±
- CloudFrontë¡œ ì •ì  íŒŒì¼ ë°°í¬
- Redisë¡œ í•« ë°ì´í„° ìºì‹±
- Stale-While-Revalidate ì „ëµ

---

## ğŸ“ ë¬¸ì˜ ë° ì§€ì›

ê¸°ìˆ  ë¬¸ì„œ ê´€ë ¨ ë¬¸ì˜: tech@workfreemarket.com


