import * as XLSX from 'xlsx';
import * as path from 'path';
import * as fs from 'fs';
import { execSync } from 'child_process';

// README ë°ì´í„° êµ¬ì¡°í™”
const readmeData: Record<string, (string | number)[][]> = {
  'í”„ë¡œì íŠ¸_ê°œìš”': [
    ['í•­ëª©', 'ë‚´ìš©'],
    ['í”„ë¡œì íŠ¸ëª…', 'WorkFree - ì§ì¥ì¸ AI ìë™í™” SaaS'],
    ['ìŠ¬ë¡œê±´', 'í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ì—…ë¬´ 3ì‹œê°„ ë‹¨ì¶•'],
    ['ì„¤ëª…', 'ì§ì¥ì¸ë“¤ì´ ë°˜ë³µì ì¸ ì—…ë¬´ë¥¼ AIë¡œ ìë™í™”í•˜ì—¬ í•˜ë£¨ 2-3ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ì›¹ ê¸°ë°˜ SaaS í”Œë«í¼'],
    ['í•µì‹¬ íŠ¹ì§•', 'ì¦‰ì‹œ ì‚¬ìš©, í•œê¸€ ì™„ë²½ ì§€ì›, ì‚¬ìš©í•œ ë§Œí¼ë§Œ ê²°ì œ, ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜'],
  ],
  
  'ì œê³µ_ë„êµ¬_7ê°œ': [
    ['ë„êµ¬', 'ì‹œê°„ ì ˆì•½', 'ê°€ê²©', 'íƒ€ê²Ÿ', 'ìƒíƒœ'],
    ['ë¸”ë¡œê·¸ ìƒì„±ê¸°', '1ì‹œê°„ â†’ 10ë¶„', '3C', 'ë§ˆì¼€í„°', 'âœ… êµ¬í˜„ë¨'],
    ['ë³´ê³ ì„œ ìƒì„±ê¸°', '2ì‹œê°„ â†’ 15ë¶„', '5C', 'ê¸°íšì', 'âœ… êµ¬í˜„ë¨'],
    ['ì´ë¯¸ì§€ ê²€ìƒ‰', '30ë¶„ â†’ 3ë¶„', '1C', 'ë””ìì´ë„ˆ', 'âœ… êµ¬í˜„ë¨'],
    ['QR ìƒì„±ê¸°', '1ì‹œê°„ â†’ 5ë¶„', '2C', 'ë§ˆì¼€íŒ…', 'âœ… êµ¬í˜„ë¨'],
    ['ì´ë©”ì¼ í…œí”Œë¦¿', '30ë¶„ â†’ 5ë¶„', '1C', 'ì˜ì—…', 'âœ… êµ¬í˜„ë¨'],
    ['í™˜ìœ¨ ì•Œë¦¬ë¯¸', 'ë§¤ì¼ 10ë¶„', '2C', 'ë¬´ì—­', 'âœ… êµ¬í˜„ë¨'],
    ['FRI ë§¤ë‰´ì–¼ë´‡', '20ë¶„ â†’ 2ë¶„', '1C', 'ì „ ì§êµ°', 'âœ… êµ¬í˜„ë¨'],
  ],
  
  'ê°€ê²©_ì •ì±…': [
    ['íŒ¨í‚¤ì§€', 'ê°€ê²©', 'í¬ë ˆë”§', 'ë³´ë„ˆìŠ¤', '1Cë‹¹ ê°€ê²©'],
    ['ìŠ¤íƒ€í„°', '10,000ì›', '10C', '-', '1,000ì›'],
    ['ë² ì´ì§', '30,000ì›', '35C', '+5C', '857ì›'],
    ['í”„ë¡œ', '50,000ì›', '60C', '+10C', '833ì›'],
    ['í”„ë¦¬ë¯¸ì—„', '100,000ì›', '130C', '+30C', '769ì›'],
    ['', '', '', '', ''],
    ['ì›”ê°„ êµ¬ë… (ì¶œì‹œ ì˜ˆì •)', '', '', '', ''],
    ['í”„ë¦¬ë¯¸ì—„', '29,900ì›/ì›”', '40C/ì›”', 'í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥', ''],
    ['íŒ€', '99,000ì›/ì›”', '200C ê³µìœ ', '10ëª…', ''],
    ['ì—”í„°í”„ë¼ì´ì¦ˆ', 'ë§ì¶¤ ê²¬ì ', '100ëª… ì´ìƒ', '', ''],
  ],
  
  'ê¸°ìˆ _ìŠ¤íƒ': [
    ['ì¹´í…Œê³ ë¦¬', 'ê¸°ìˆ ', 'ìš©ë„'],
    ['Frontend', 'Next.js 15', 'App Router ê¸°ë°˜ React í”„ë ˆì„ì›Œí¬'],
    ['Frontend', 'React 19', 'ìµœì‹  React ê¸°ëŠ¥ í™œìš©'],
    ['Frontend', 'TypeScript', 'íƒ€ì… ì•ˆì •ì„±'],
    ['Frontend', 'Tailwind CSS 4', 'ìœ í‹¸ë¦¬í‹° ê¸°ë°˜ ìŠ¤íƒ€ì¼ë§'],
    ['Frontend', 'Framer Motion', 'ì• ë‹ˆë©”ì´ì…˜'],
    ['Backend', 'Supabase', 'PostgreSQL ë°ì´í„°ë² ì´ìŠ¤, Auth, RLS'],
    ['Backend', 'Firebase', 'íŒŒì¼ ìŠ¤í† ë¦¬ì§€, ì‹¤ì‹œê°„ DB'],
    ['Backend', 'Vercel', 'ì„œë²„ë¦¬ìŠ¤ API Routes'],
    ['AI', 'OpenAI API', 'GPT-4 ê¸°ë°˜ AI ì½˜í…ì¸  ìƒì„±'],
    ['Payment', 'Toss Payments', 'êµ­ë‚´ ê°„í¸ê²°ì œ'],
    ['Email', 'Resend', 'íŠ¸ëœì­ì…˜ ì´ë©”ì¼ ë°œì†¡'],
    ['Infrastructure', 'Vercel', 'í˜¸ìŠ¤íŒ… ë° ë°°í¬'],
    ['Infrastructure', 'AWS S3', 'íŒŒì¼ ì €ì¥ (ì˜ˆì •)'],
    ['Infrastructure', 'Cloudflare', 'CDN ë° DDoS ë°©ì–´ (ì˜ˆì •)'],
  ],
  
  'ì™„ë£Œëœ_ê¸°ëŠ¥': [
    ['ê¸°ëŠ¥', 'ìƒíƒœ', 'ë¹„ê³ '],
    ['7ê°œ AI ë„êµ¬ êµ¬í˜„', 'âœ… ì™„ë£Œ', 'ë¸”ë¡œê·¸, ë³´ê³ ì„œ, ì´ë¯¸ì§€, QR, ì´ë©”ì¼, í™˜ìœ¨, ì±—ë´‡'],
    ['í¬ë ˆë”§ ì‹œìŠ¤í…œ êµ¬ì¶•', 'âœ… ì™„ë£Œ', 'êµ¬ë§¤, ì°¨ê°, ì¡°íšŒ'],
    ['ê²°ì œ ì‹œìŠ¤í…œ í†µí•©', 'âœ… ì™„ë£Œ', 'Toss Payments'],
    ['ì‚¬ìš©ì ì¸ì¦', 'âœ… ì™„ë£Œ', 'Firebase Auth'],
    ['ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ', 'âœ… ì™„ë£Œ', ''],
    ['í”¼ë“œë°± ì‹œìŠ¤í…œ', 'âœ… ì™„ë£Œ', ''],
    ['Analytics ëŒ€ì‹œë³´ë“œ', 'âœ… ì™„ë£Œ', ''],
  ],
  
  'ì§„í–‰_ì¤‘': [
    ['í•­ëª©', 'ìƒíƒœ', 'ëª©í‘œ'],
    ['ë² íƒ€ í…ŒìŠ¤í„° ëª¨ì§‘', 'ğŸ”„ ì§„í–‰ ì¤‘', '100ëª…'],
    ['ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘', 'ğŸ”„ ì§„í–‰ ì¤‘', ''],
    ['ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ ê³ ë„í™”', 'ğŸ”„ ì§„í–‰ ì¤‘', ''],
    ['ì„±ëŠ¥ ìµœì í™”', 'ğŸ”„ ì§„í–‰ ì¤‘', ''],
  ],
  
  'í–¥í›„_ê³„íš': [
    ['Phase', 'ê¸°ê°„', 'ì£¼ìš” ê¸°ëŠ¥'],
    ['Phase 2', '1-3ê°œì›”', 'ì›”ê°„ êµ¬ë… ëª¨ë¸, íŒ€ í˜‘ì—…, ëª¨ë°”ì¼ ìµœì í™”, ì¶”ê°€ AI ë„êµ¬ 5ê°œ'],
    ['Phase 3', '4-6ê°œì›”', 'B2B ê¸°ì—…ìš© í”Œëœ, API ì œê³µ, í…œí”Œë¦¿ ë§ˆì¼“í”Œë ˆì´ìŠ¤, ë‹¤êµ­ì–´ ì§€ì›'],
    ['Phase 4', '7-12ê°œì›”', 'ìì²´ Fine-tuned AI ëª¨ë¸, ë¸Œë¼ìš°ì € í™•ì¥, Slack/MS Teams ì—°ë™, ì‹œë¦¬ì¦ˆA'],
  ],
  
  'ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜': [
    ['ê¸°ëŠ¥', 'ì„¤ëª…'],
    ['ë ˆë²¨ ì‹œìŠ¤í…œ', 'Bronze â†’ Silver â†’ Gold â†’ Platinum'],
    ['ì‹œê°„ ì€í–‰', 'ì ˆì•½í•œ ì‹œê°„ì„ í¬ë ˆë”§ìœ¼ë¡œ ì „í™˜ (10ì‹œê°„ = 1C)'],
    ['ë¯¸ì…˜', 'ì¼ì¼/ì£¼ê°„ í€˜ìŠ¤íŠ¸ ì™„ë£Œ ì‹œ ë³´ìƒ í¬ë ˆë”§'],
    ['ì¶”ì²œ í”„ë¡œê·¸ë¨', 'ì¹œêµ¬ ì´ˆëŒ€ ì‹œ ì–‘ì¸¡ 2C ì ë¦½'],
    ['ì—…ì  ì‹œìŠ¤í…œ', 'íŠ¹ì • ë§ˆì¼ìŠ¤í†¤ ë‹¬ì„± ì‹œ ë±ƒì§€ íšë“'],
  ],
  
  'ë² íƒ€_í”„ë¡œê·¸ë¨': [
    ['í˜œíƒ', 'ë‚´ìš©'],
    ['ë¬´ë£Œ í¬ë ˆë”§', '10C ì œê³µ'],
    ['ì²« ê²°ì œ í• ì¸', '50% í• ì¸'],
    ['ì–¼ë¦¬ì–´ë‹µí„° ë±ƒì§€', 'í‰ìƒ ìœ ì§€'],
    ['ì‹ ê·œ ê¸°ëŠ¥ ìš°ì„  ì²´í—˜', ''],
    ['í”¼ë“œë°± ë³´ìƒ', 'í”¼ë“œë°± ë°˜ì˜ ì‹œ ì¶”ê°€ í¬ë ˆë”§'],
    ['ëª©í‘œ', 'ë² íƒ€ í…ŒìŠ¤í„° 100ëª… ëª¨ì§‘'],
  ],
};

// ì—‘ì…€ íŒŒì¼ ìƒì„±
function createExcelFile() {
  const workbook = XLSX.utils.book_new();
  
  // ê° ì‹œíŠ¸ ìƒì„±
  Object.entries(readmeData).forEach(([sheetName, data]) => {
    const worksheet = XLSX.utils.aoa_to_sheet(data);
    
    // ì—´ ë„ˆë¹„ ìë™ ì¡°ì •
    const colWidths = data[0].map((_, colIndex) => {
      const maxLength = Math.max(
        ...data.map(row => String(row[colIndex] || '').length)
      );
      return { wch: Math.min(maxLength + 2, 50) };
    });
    worksheet['!cols'] = colWidths;
    
    XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);
  });
  
  // ë°”íƒ•í™”ë©´ ê²½ë¡œ
  let desktopPath = '';
  try {
    desktopPath = execSync(
      'powershell -Command "[Environment]::GetFolderPath(\'Desktop\')"',
      { encoding: 'utf-8' }
    ).trim();
  } catch (error) {
    const { homedir } = require('os');
    desktopPath = path.join(homedir(), 'Desktop');
  }
  
  if (!fs.existsSync(desktopPath)) {
    fs.mkdirSync(desktopPath, { recursive: true });
  }
  
  const today = new Date().toISOString().split('T')[0];
  const fileName = `WorkFree_í”„ë¡œì íŠ¸_ì„¤ëª…ì„œ_${today}.xlsx`;
  
  // 1. ë°”íƒ•í™”ë©´ì— ì €ì¥
  const desktopFilePath = path.join(desktopPath, fileName);
  XLSX.writeFile(workbook, desktopFilePath);
  
  // 2. í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ë„ ì €ì¥
  const projectFilePath = path.join(process.cwd(), fileName);
  XLSX.writeFile(workbook, projectFilePath);
  
  console.log(`\nâœ… í”„ë¡œì íŠ¸ ì„¤ëª…ì„œ ì—‘ì…€ íŒŒì¼ ìƒì„± ì™„ë£Œ!`);
  console.log(`ğŸ“ ë°”íƒ•í™”ë©´: ${desktopFilePath}`);
  console.log(`ğŸ“ í”„ë¡œì íŠ¸ í´ë”: ${projectFilePath}`);
  console.log(`\nğŸ’¡ ë°”íƒ•í™”ë©´ê³¼ í”„ë¡œì íŠ¸ í´ë”ì—ì„œ í™•ì¸í•˜ì„¸ìš”!`);
  
  // íŒŒì¼ íƒìƒ‰ê¸°ë¡œ ì—´ê¸°
  try {
    execSync(`explorer.exe "${desktopPath}"`);
  } catch (error) {
    // ë¬´ì‹œ
  }
  
  return { desktop: desktopFilePath, project: projectFilePath };
}

// ì‹¤í–‰
try {
  createExcelFile();
} catch (error) {
  console.error('âŒ ì˜¤ë¥˜ ë°œìƒ:', error);
  process.exit(1);
}

